> æ¬¢è¿å¤§å®¶å…³æ³¨æˆ‘çš„ LeetCode ä»£ç ä»“åº“ï¼šhttps://github.com/yanglr/leetcode-ac
> å‡ ä¹æ‰€æœ‰é¢˜ç›®éƒ½ä¼šæä¾›å¤šç§è§£æ³•ï¼ŒçœŸè¯šæ±‚starï¼

## è§£é¢˜æ€è·¯

### ç®—æ³•é€‰å–

ç”±äºæ•°æ®è§„æ¨¡æ˜¯ $1 <= n <= 10^9$, æ—¶é—´å¤æ‚åº¦ â‰¥ O(n)çš„ç®—æ³•å¯èƒ½ä¼šè¶…æ—¶ã€‚
æ•…åªèƒ½ä½¿ç”¨ O(log n) æˆ– O(1)çš„ç®—æ³•äº†ã€‚

æœ¬é¢˜å¯ä»¥è€ƒè™‘ç”¨åŠ¨æ€è§„åˆ’æ±‚è§£ï¼Œè¿™ä¸ªé¢˜åé¢åˆ†æä¼šå‘ç°ç±»ä¼¼äº**æ–æ³¢é‚£å¥‘æ•°åˆ—**ï¼Œåé¢çš„ä»£ç æä¾›äº† C++ å’Œ Javaçš„å®ç°ã€‚

**dpæ•°ç»„:**

ç”¨f(i) è¡¨ç¤ºé•¿åº¦ä¸ºi çš„ä¸å«æœ‰è¿ç»­1çš„äºŒè¿›åˆ¶æ•°(èŒƒå›´æ˜¯ iä¸ª0 ~ iä¸ª1) çš„ä¸ªæ•°ã€‚

**f(i)ä¸å‰é¢å‡ é¡¹çš„å…³ç³»æ€ä¹ˆæ‰¾ï¼Ÿ**
f(i)ç›¸å½“äºæ¯æ¬¡åœ¨f(i-1)è¡¨ç¤ºçš„é‚£äº›æ•°çš„å‰é¢è¡¥1ä¸ª0æˆ–1, f1, f2, f3, f4å¯ä»¥åˆ—è¡¨å¦‚ä¸‹:

![image.png](https://pic.leetcode-cn.com/1631450358-chkQRA-image.png)

å¤šåˆ—å‡ºå‡ ä¸ªï¼Œå°±å¯ä»¥å‘ç°è§„å¾‹äº†: `f(i) = f(i-1) + f(i-2)`

### å¯¹äºä¸€ä¸ªç»™å®šçš„æ•°ï¼Œå¦‚ä½•åšåˆ°ä¸é‡ã€ä¸æ¼åœ°ç»Ÿè®¡æ»¡è¶³è¦æ±‚çš„æ•°çš„ä¸ªæ•°?

æˆ‘ä»¬çš„æ€»ä½“åŸåˆ™æ˜¯æƒ³è¦**ä¸é‡ã€ä¸æ¼ï¼Œä¸”ä¸èƒ½å¤§äºè¾“å…¥çš„æ•°n**ã€‚
å›ºå®šä¸€éƒ¨åˆ†ï¼Œè€ƒè™‘å‰©ä¸‹çš„ä½æœ‰å¤šå°‘ç§å¯èƒ½æ€§ã€‚

å°†ä¸€ä¸ªæ•°è½¬ä¸ºäºŒè¿›åˆ¶æ ¼å¼ï¼Œä»æœ€é«˜æœ‰æ•ˆä½ï¼ˆå³ä»å·¦åˆ°å³ï¼‰å¼€å§‹æ‰«æã€‚
å¦‚æœæˆ‘ä»¬å‘ç°å³è¾¹æ¯å‡ºç°ä¸€æ¬¡ 1xxxx(1åæœ‰kä¸ªdigit, æ¯ä¸ªxè¡¨ç¤º0æˆ–1)æ ·å­çš„è¿ç»­æ•°å­—ï¼Œæ»¡è¶³ä¸å«æœ‰è¿ç»­1çš„äºŒè¿›åˆ¶æ•°çš„æ€»ä¸ªæ•°count å°±éœ€è¦å¢åŠ f(k)ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ•°å­—ä¸Šæ”¾ä¸€ä¸ª'0'ï¼Œåé¢æ”¾ä»»æ„ä¸€ä¸ªæœ‰æ•ˆé•¿åº¦ä¸ºkçš„å­—ç¬¦ä¸²ï¼›ä¹‹åï¼Œæˆ‘ä»¬ç»§ç»­å¾ªç¯è€ƒè™‘å‰©ä¸‹çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸ªdigitä¸Šæ”¾ä¸€ä¸ª'1'ã€‚å¦‚æœå‘ç°æœ‰è¿ç»­çš„1ï¼Œæˆ‘ä»¬å°±é€€å‡ºå¾ªç¯å¹¶è¿”å›ç­”æ¡ˆã€‚åœ¨å¾ªç¯ç»“æŸæ—¶ï¼Œæˆ‘ä»¬è¿”å›count+1ï¼ŒåŒ…æ‹¬æ•°å­—næœ¬èº«ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœnæ˜¯10010110ï¼Œæ¥ä¸‹æ¥éœ€è¦æ‰¾åˆ°æ¯”nå°çš„ä¸”æ²¡æœ‰è¿ç»­1çš„æ•°:
1. æˆ‘ä»¬**åªæŠŠç¬¬1ä¸ªæœ‰æ•ˆä½1æ¢ä¸º0**ï¼Œè¿™ä¸ª1åé¢æ€ä¹ˆæ”¾æ•°å­—ï¼Œéƒ½ä¼šæ¯”nå°ï¼Œå…¶ä¸­æœ€å¤§çš„æ•°æ˜¯æœ«å°¾7ä½éƒ½æ˜¯â€œ1â€çš„æ•°ï¼Œè¿™äº›æ•°å¯ä»¥ç”¨èŒƒå›´ 00000000-01111111è¡¨ç¤ºï¼Œå…¶ä¸­æ»¡è¶³ä¸å«æœ‰è¿ç»­1çš„äºŒè¿›åˆ¶æ•°çš„ä¸ªæ•°ä¸º f(7)ã€‚
2. æˆ‘ä»¬**åªæŠŠç¬¬2ä¸ªæœ‰æ•ˆä½1æ¢ä¸º0**ï¼Œè¿™ä¸ª1åé¢æ€ä¹ˆæ”¾æ•°å­—ï¼Œéƒ½ä¼šæ¯”nå°ï¼Œå…¶ä¸­æœ€å¤§çš„æ•°æ˜¯æœ«å°¾4ä½éƒ½æ˜¯â€œ1â€çš„æ•°ï¼Œè¿™äº›æ•°å¯ä»¥ç”¨èŒƒå›´ 10000000-10001111è¡¨ç¤ºï¼Œæ•°çš„ä¸ªæ•°ä¸º 0000-1111ï¼Œå…¶ä¸­æ»¡è¶³ä¸å«æœ‰è¿ç»­1çš„äºŒè¿›åˆ¶æ•°çš„ä¸ªæ•°ä¸ºf(4)ã€‚
3. æˆ‘ä»¬**åªæŠŠç¬¬3ä¸ªæœ‰æ•ˆä½1æ¢ä¸º0**ï¼Œè¿™ä¸ª1åé¢æ€ä¹ˆæ”¾æ•°å­—ï¼Œéƒ½ä¼šæ¯”nå°ï¼Œå…¶ä¸­æœ€å¤§çš„æ•°æ˜¯æœ«å°¾2ä½éƒ½æ˜¯â€œ1â€çš„æ•°ï¼Œè¿™äº›æ•°å¯ä»¥ç”¨èŒƒå›´10010000-10010011è¡¨ç¤ºï¼Œæ•°çš„ä¸ªæ•°ä¸º 00~11ï¼Œå…¶ä¸­æ»¡è¶³ä¸å«æœ‰è¿ç»­1çš„äºŒè¿›åˆ¶æ•°çš„ä¸ªæ•°ä¸ºf(2)ã€‚
4. æˆ‘ä»¬**åªæŠŠç¬¬4ä¸ªæœ‰æ•ˆä½1æ¢ä¸º0**ï¼Œè¿™ä¸ª1åé¢æ€ä¹ˆæ”¾æ•°å­—ï¼Œéƒ½ä¼šæ¯”nå°ï¼Œå…¶ä¸­æœ€å¤§çš„æ•°æ˜¯æœ«å°¾1ä½æ˜¯â€œ1â€çš„æ•°ï¼Œäº›æ•°å¯ä»¥ç”¨èŒƒå›´ 10010100-10010101è¡¨ç¤ºï¼Œæ•°çš„ä¸ªæ•°ä¸º 0~1ï¼Œå…¶ä¸­æ»¡è¶³ä¸å«æœ‰è¿ç»­1çš„äºŒè¿›åˆ¶æ•°çš„ä¸ªæ•°ä¸ºf(1)ã€‚

ç»“åˆä¸‹å›¾çœ‹æ›´ç›´è§‚~

**ps**: æ•°çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸­æœ‰å‡ ä¸ª1(æ¯”å¦‚ï¼Œæœ‰kä¸ª1)ï¼Œè¿™é‡Œå°±æœ‰å‡ ä¸ª(kä¸ª)æ­¥éª¤ã€‚

æ¥ä¸‹æ¥çš„æ“ä½œæ˜¯éœ€è¦åœ¨äºŒè¿›åˆ¶æ•° 1001011x ä¸Šåšå˜æ¢çš„ï¼Œä½†1001011xå·²å‡ºç°è¿ç»­çš„1ï¼Œéæ³•äº†ï¼Œæ•…ä¸è¿›å…¥è®¡æ•°ã€‚

![image.png](https://pic.leetcode-cn.com/1631336206-KIdIcj-image.png)

## å·²ACçš„ä»£ç å¦‚ä¸‹:

* []

```C++
class Solution {
public:
    int findIntegers(int n) {
        vector<int> f(32);
        f[0] = 1;
        f[1] = 2;
        for (int i = 2; i < 32; i++)
            f[i] = f[i - 1] + f[i - 2];
        string numStr = toBinary(n);
        int res = 0;
        for (int i = 0; i < numStr.size(); i++) {
            if (numStr[i] == '0') /* é€‰å‡ºnumStr[i] = '1'çš„digit */
                continue;
            res += f[numStr.size() - i - 1];
            if (i != 0 && numStr[i - 1] == '1')
                return res;
        }
        return res + 1;
    }
    string toBinary(long n)  /* éè´Ÿæ•´æ•°è½¬äºŒè¿›åˆ¶è¡¨ç¤ºçš„å­—ç¬¦ä¸² */
    {
        string res = "";
        while (n > 0)
        {
            char r = n % 2 + '0';
            res.push_back(r);     /* è®°ä½: æ”¾è¿›å»çš„ç»“æœä¼šå¯¼è‡´ä½ä½åœ¨å‰, é«˜ä½åœ¨å */
            n /= 2;
        }
        reverse(res.begin(), res.end());
        return res;
    }
};
```

* []

```Java
class Solution {
    public int findIntegers(int num) {
        int[] dp = new int[32];
        dp[0] = 1;
        dp[1] = 2;
        for (int i = 2; i < 32; i++)
            dp[i] = dp[i - 1] + dp[i - 2];
        String numStr = getBinary(num);
        int res = 0;
        for (int i = 0; i < numStr.length(); i++) {
            if (numStr.charAt(i) == '0')
                continue;
            res += dp[numStr.length() - i - 1];
            if (i != 0 && numStr.charAt(i - 1) == '1')
                return res;
        }
        return res + 1;
    }
    // å°†éè´Ÿæ•´æ•°è½¬ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²
    private String getBinary(int num) {
        StringBuilder sb = new StringBuilder();
        while (num > 0)
        {
            sb.insert(0, num & 1);
            num >>= 1;
        }
        return sb.toString();
    }
}
```

<br />

## æ—¶é—´å¤æ‚åº¦ä¼˜åŒ–, æ—¶é—´å¤æ‚åº¦è¶…è¿‡äº†100% çš„æäº¤

æ¥ä¸‹æ¥, è¯•äº†ä¸€ä¸‹ä¸è½¬ä¸ºå­—ç¬¦ä¸²åšåç»­æ“ä½œ, åç»­å¤„ç†éƒ½æ”¹ç”¨ä½è¿ç®—, è¿è¡Œæ—¶é—´è¶…è¿‡äº†100% çš„æäº¤ã€‚

### å·²ACçš„C++ä»£ç ä¸º:

* cpp

```cpp
class Solution {
public:
    int findIntegers(int num) {
        int f[32];
        f[0] = 1;
        f[1] = 2;
        for (int i = 2; i < 32; ++i)
            f[i] = f[i - 1] + f[i - 2];
        int res = 0;
        int preBit = 0; // è®°å½•å½“å‰digitçš„å‰ä¸€ä¸ªdigit
        int k = 30;     // æŒ‡é’ˆk, ä»äºŒè¿›åˆ¶æ•°çš„æœ«ä½å¼€å§‹å‘å‰ç§»åŠ¨
        while (k >= 0)
        {
            if (num & (1 << k)) // ä»ä½ä½å‘é«˜ä½æ‰«æ, åˆ¤æ–­ç¬¬kä½æ˜¯å¦ä¸º1
            {
                res += f[k];
                if (preBit) return res; // å‡ºç°äº†è¿ç»­çš„1, ç›´æ¥è¿”å›res
                preBit = 1; // å½“å‰digitæ˜¯1, å°†preBitæ›´æ–°ä¸ºå½“å‰digit 1, ä¸ºä¸‹ä¸€è½®è¿­ä»£åšå‡†å¤‡
            }
            else preBit = 0;

            --k;
        }
        return res + 1; // ç®—ä¸Š num æœ¬èº«
    }
};
```

#### è¿è¡Œç»“æœ:

![image.png](https://pic.leetcode-cn.com/1631339184-xanjPs-image.png)

<br />

## ç©ºé—´å¤æ‚åº¦ä¼˜åŒ–, ç©ºé—´å¤æ‚åº¦è¶…è¿‡äº†97.89% çš„æäº¤

ä¸ç”¨dpæ•°ç»„ï¼Œç›´æ¥ç”¨ä¸´æ—¶å˜é‡å¯ä»¥å—ï¼Ÿå½“ç„¶å¯ä»¥ã€‚

### å·²ACçš„C++ä»£ç ä¸º:

* cpp

```cpp
class Solution {
public:
    int findIntegers(int num) {      
        int res = 0;
        int preBit = 0; // è®°å½•å½“å‰digitçš„å‰ä¸€ä¸ªdigit
        int k = 30;     // æŒ‡é’ˆk, ä»äºŒè¿›åˆ¶æ•°çš„æœ«ä½å¼€å§‹å‘å‰ç§»åŠ¨
        while (k >= 0)
        {
            if (num & (1 << k)) // ä»ä½ä½å‘é«˜ä½æ‰«æ, åˆ¤æ–­ç¬¬kä½æ˜¯å¦ä¸º1
            {
                res += getF(k);
                if (preBit) return res; // å‡ºç°äº†è¿ç»­çš„1, ç›´æ¥è¿”å›res
                preBit = 1; // å°†preBitæ›´æ–°ä¸ºå½“å‰digit 1, ä¸ºä¸‹ä¸€è½®è¿­ä»£åšå‡†å¤‡
            }
            else preBit = 0;

            --k;
        }
        return res + 1; // ç®—ä¸Š num æœ¬èº«
    }
    int getF(int k) /* è®¡ç®—f(k) */
    {
        int f_i_1 = 1, f_i_2 = 2, f_i_3 = 3;
        if (k == 0) return f_i_1;
        if (k == 1) return f_i_2;      
        for (int i = 2; i <= k; i++)  /* å·²çŸ¥f1, æ±‚fnæ€»å…±éœ€è¦è¿­ä»£n-1+1-maxIndexGap(2) = n-2 æ¬¡ */
        {
            // f_n = f_n-1 + f_n-2
            f_i_3 = f_i_2 + f_i_1;
            f_i_1 = f_i_2;
            f_i_2 = f_i_3;
        }
        return f_i_3;         
    }
};
```

#### è¿è¡Œç»“æœ:

![image.png](https://pic.leetcode-cn.com/1631339976-egwFto-image.png)

---

å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯**æå®¢å­¦é•¿**ï¼Œç‚¹å‡»[æˆ‘çš„å¤´åƒ](https://github.com/yanglr/leetcode-ac)ï¼ŒæŸ¥çœ‹åŠ›æ‰£è¯¦ç»†åˆ·é¢˜æ”»ç•¥ï¼Œä½ ä¼šå‘ç°ç›¸è§æ¨æ™šï¼

**å¦‚æœæ„Ÿè§‰é¢˜è§£å¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¸è¦åå•¬ç»™ä¸€ä¸ªğŸ‘å§ï¼**

<br />

å¥½äº†ï¼Œ**ACä¸€æ—¶çˆ½ï¼Œä¸€ç›´ACä¸€ç›´çˆ½**ï¼

**ps:** ä»“åº“çš„ä»£ç ä¸­å¯ä»¥ç›´æ¥æ‹¿æ¥æœ¬åœ°è°ƒè¯•å–”ï¼Œæ¡†æ¶å·²æ­å¥½ï¼Œæ ¹æ®è‡ªå·±çš„éœ€æ±‚è°ƒæ•´ test caseå³å¯~

<br />

**å‚è€ƒ:**
C++, Non-DP, O(32) Fibonacci solution
https://leetcode.com/problems/non-negative-integers-without-consecutive-ones/discuss/103754/C%2B%2B-Non-DP-O(32)-Fibonacci-solution

https://www.bilibili.com/video/BV1bb4y1X7ZL - éƒ­éƒ­

